# 七龙珠横版格斗游戏开发计划(修订版)

## 技术栈
- React + TypeScript
- Three.js (3D渲染)
- Vite (构建工具)
- TailwindCSS (样式)
- ECS架构 (实体-组件-系统)
- Canvas/SVG (角色场景绘制)

## 项目结构
```
├── src/
│   ├── ecs/              # ECS架构核心
│   │   ├── Entity.ts     # 实体类
│   │   ├── Component.ts  # 组件基类
│   │   ├── System.ts     # 系统基类
│   │   └── World.ts      # 世界管理
│   ├── components/       # React组件
│   │   ├── GameCanvas.tsx # 游戏主画布
│   │   └── UI.tsx        # 游戏UI
│   ├── game/             # 游戏核心
│   │   ├── systems/      # 游戏系统
│   │   │   ├── RenderSystem.ts  # 渲染系统
│   │   │   ├── PhysicsSystem.ts # 物理系统
│   │   │   ├── InputSystem.ts   # 输入系统
│   │   │   ├── AISystem.ts      # AI系统
│   │   │   ├── AnimationSystem.ts # 动画系统
│   │   │   └── DrawingSystem.ts   # 绘制系统(新增)
│   │   ├── components/   # 游戏组件
│   │   │   ├── Transform.ts     # 位置旋转缩放
│   │   │   ├── Sprite.ts        # 精灵渲染
│   │   │   ├── Collider.ts      # 碰撞体
│   │   │   ├── Controller.ts    # 控制器
│   │   │   ├── Health.ts        # 生命值
│   │   │   └── Drawable.ts      # 可绘制组件(新增)
│   │   ├── entities/     # 游戏实体
│   │   │   ├── Player.ts        # 玩家实体
│   │   │   └── Enemy.ts         # 敌人实体
│   │   ├── stages/       # 游戏关卡
│   │   │   ├── Stage1.ts        # 悟空遇布玛
│   │   │   ├── Stage2.ts        # 寻找龙珠-关卡1
│   │   │   ├── Stage3.ts        # 寻找龙珠-关卡2
│   │   │   ├── Stage4.ts        # 寻找龙珠-关卡3
│   │   │   ├── Stage5.ts        # 寻找龙珠-关卡4
│   │   │   ├── Stage6.ts        # 天下第一武道会预选赛
│   │   │   ├── Stage7.ts        # 天下第一武道会决赛
│   │   │   └── Stage8.ts        # 对战短笛大魔王
│   │   └── drawing/       # 绘制模块(新增)
│   │       ├── CharacterDrawer.ts # 角色绘制
│   │       ├── SceneDrawer.ts    # 场景绘制
│   │       └── UIDrawer.ts       # UI绘制
│   └── App.tsx           # 应用入口
└── package.json
```

## 核心实现步骤

### 1. 项目初始化
- 使用Vite创建React+TypeScript项目
- 安装Three.js和TailwindCSS
- 配置开发环境

### 2. ECS架构实现
- 实现Entity、Component、System基类
- 实现World管理类，负责实体和系统的生命周期

### 3. 绘制模块实现
- **CharacterDrawer**：使用Canvas/SVG绘制角色（悟空、布玛、敌人等）
- **SceneDrawer**：绘制游戏场景（地图、障碍物、道具等）
- **UIDrawer**：绘制游戏UI元素
- 设计统一接口，方便后续替换为纹理素材

### 4. 游戏核心系统
- **渲染系统**：使用Three.js渲染游戏场景和实体
- **物理系统**：实现碰撞检测和基本物理效果
- **输入系统**：处理键盘和游戏手柄输入
- **AI系统**：实现敌人的智能行为
- **动画系统**：处理角色动画和过渡
- **绘制系统**：管理Canvas/SVG绘制逻辑

### 5. 七龙珠游戏内容

#### 角色设计
- **悟空**：主角，可使用龟派气功、界王拳等技能
- **布玛**：NPC角色，推动剧情发展
- **敌人**：雅木茶、天津饭、饺子、短笛大魔王等
- **Boss**：比克大魔王、短笛大魔王等

#### 关卡设计

##### 1. **悟空遇布玛**（Stage1）
- 场景：包子山
- 剧情：悟空初次遇到布玛，了解龙珠的秘密
- 玩法：教学关卡，学习基本移动和攻击

##### 2. **寻找龙珠**阶段

**关卡1：包子山冒险**（Stage2）
- 场景：包子山深处
- 敌人：野兽、小喽啰
- 目标：寻找第一颗龙珠
- 特色：森林地形，跳跃障碍

**关卡2：沙漠之旅**（Stage3）
- 场景：沙漠
- 敌人：沙漠土匪、沙虫
- 目标：寻找第二颗龙珠，遇到雅木茶
- 特色：沙漠环境，沙尘暴天气效果

**关卡3：火焰山**（Stage4）
- 场景：火焰山
- 敌人：火焰怪兽、红缎带军团士兵
- 目标：寻找第三颗龙珠，挑战牛魔王
- 特色：火山地形，熔岩陷阱

**关卡4：海底探险**（Stage5）
- 场景：海底洞穴
- 敌人：海怪、水下机器人
- 目标：寻找第四颗龙珠
- 特色：水下环境，浮力系统

**关卡5：红缎带军团总部**（Stage6）
- 场景：红缎带军团基地
- 敌人：红缎带士兵、机甲战士
- 目标：寻找剩余龙珠，击败黑元帅
- 特色：基地设施，机关陷阱

##### 3. **天下第一武道会**阶段

**预选赛**（Stage7）
- 场景：武道会擂台
- 敌人：各种武道高手
- 目标：击败对手，晋级决赛
- 特色：一对一擂台赛，观众欢呼效果

**决赛**（Stage8）
- 场景：武道会决赛擂台
- 对手：雅木茶 → 天津饭 → 短笛
- 目标：获得天下第一武道会冠军
- 特色：逐步提升的对手强度，精彩的BOSS战

##### 4. **对战短笛大魔王**（Stage9）
- 场景：短笛大魔王城堡
- 敌人：短笛大魔王
- 目标：拯救世界，击败短笛大魔王
- 特色：最终BOSS战，多阶段战斗

#### 战斗系统
- 基础攻击：拳打脚踢
- 特殊技能：龟派气功、气功波、界王拳等
- 防御和闪避
- 能量系统：技能消耗能量
- 连击系统：连续攻击加成
- 必杀技：终结技动画

### 6. 游戏UI
- 生命值显示
- 能量条
- 关卡信息
- 技能按钮
- 游戏菜单
- 剧情对话系统

## 开发优先级
1. 项目初始化和ECS架构搭建
2. 绘制模块实现（Canvas/SVG绘制）
3. 核心系统实现（渲染、物理、输入）
4. 基础角色和第一关卡
5. 战斗系统
6. AI系统
7. 剩余关卡开发
8. 优化和测试

## 预期功能
- 流畅的2D/3D混合战斗体验
- 完整的七龙珠剧情线
- 多样化的角色技能
- 智能AI对手
- 精美的Canvas/SVG绘制
- 响应式设计，支持不同设备
- 模块化设计，方便后续替换素材

这个计划将帮助我们构建一个基于ECS架构的高质量七龙珠横版格斗游戏，从悟空遇到布玛开始，一直到天下第一武道会对战短笛大魔王的完整剧情，并详细规划了寻找龙珠阶段的各个小关卡。